import numpy as np
from scipy.integrate import cumtrapz

def integrate_ringworld_velocity(y_force, angles, radius, ringworld_velocity, normalize_to_first=True):
    """
    Integrate tangential forces with respect to arc-length to produce velocity map.
    
    Parameters:
    -----------
    y_force : numpy.ndarray
        Array of tangential forces (y-component forces)
    angles : numpy.ndarray  
        Array of angles corresponding to positions on the ringworld (in radians)
    radius : float
        Radius of the ringworld
    ringworld_velocity : float
        Orbital velocity of the ringworld (for unit conversion)
    normalize_to_first : bool, default=True
        Whether to normalize the velocity map so the first value is 0
        
    Returns:
    --------
    velocity_map : numpy.ndarray
        Integrated velocity values at each angle position (zero average)
    arc_lengths : numpy.ndarray
        Arc-length coordinates for reference
        
    Notes:
    ------
    - Integration is performed using trapezoidal rule
    - Arc-length is calculated as angle * radius
    - Result is multiplied by 1/ringworld_velocity for correct units
    - Average is subtracted so the velocity map averages to zero
    - Assumes mass = 1 for simplicity (force = acceleration)
    """
    
    # Validate inputs
    if len(y_force) != len(angles):
        raise ValueError("y_force and angles arrays must have the same length")
    
    if len(angles) < 2:
        raise ValueError("Need at least 2 data points for integration")
        
    # Calculate arc-length coordinates
    arc_lengths = angles * radius
    
    # Integrate force with respect to arc-length using trapezoidal rule
    # This gives us the change in velocity (assuming unit mass)
    velocity_changes = cumtrapz(y_force, arc_lengths, initial=0)
    
    # Apply unit conversion factor
    velocity_changes = velocity_changes / ringworld_velocity
    
    # Subtract the average so the result averages to zero
    velocity_map = velocity_changes - np.mean(velocity_changes)
    
    # Normalize to first point if requested
    if normalize_to_first:
        velocity_map = velocity_map - velocity_map[0]
    
    return velocity_map, arc_lengths

def plot_velocity_results(angles, y_force, velocity_map, radius, ringworld_velocity):
    """
    Utility function to plot the force input and velocity output.
    
    Parameters:
    -----------
    angles : numpy.ndarray
        Angle array
    y_force : numpy.ndarray  
        Force array
    velocity_map : numpy.ndarray
        Computed velocity map
    radius : float
        Ringworld radius
    ringworld_velocity : float
        Ringworld orbital velocity
    """
    import matplotlib.pyplot as plt
    
    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 8))
    
    # Plot forces
    ax1.plot(np.degrees(angles), y_force, 'b-', linewidth=2)
    ax1.set_xlabel('Angle (degrees)')
    ax1.set_ylabel('Tangential Force')
    ax1.set_title('Input: Tangential Forces vs Angle')
    ax1.grid(True, alpha=0.3)
    
    # Plot velocity
    ax2.plot(np.degrees(angles), velocity_map, 'r-', linewidth=2)
    ax2.set_xlabel('Angle (degrees)')
    ax2.set_ylabel('Velocity Perturbation')
    ax2.set_title(f'Output: Velocity Map (R = {radius}, V = {ringworld_velocity})')
    ax2.axhline(y=0, color='k', linestyle='--', alpha=0.5, label='Zero average')
    ax2.grid(True, alpha=0.3)
    ax2.legend()
    
    plt.tight_layout()
    plt.show()


if __name__ == "__main__":
    angles = np.array([0.0, 0.006283185307179587, 0.012566370614359173, 0.01884955592153876, 0.025132741228718346, 0.031415926535897934, 0.03769911184307752, 0.0439822971502571, 0.05026548245743669, 0.05654866776461628, 0.06283185307179587, 0.06911503837897544, 0.07539822368615504, 0.08168140899333463, 0.0879645943005142, 0.09424777960769379, 0.10053096491487339, 0.10681415022205297, 0.11309733552923255, 0.11938052083641214, 0.12566370614359174, 0.13194689145077132, 0.13823007675795088, 0.1445132620651305, 0.15079644737231007, 0.15707963267948966, 0.16336281798666927, 0.16964600329384882, 0.1759291886010284, 0.18221237390820802, 0.18849555921538758, 0.19477874452256716, 0.20106192982974677, 0.20734511513692636, 0.21362830044410594, 0.21991148575128552, 0.2261946710584651, 0.2324778563656447, 0.23876104167282428, 0.24504422698000386, 0.25132741228718347, 0.257610597594363, 0.26389378290154264, 0.2701769682087222, 0.27646015351590175, 0.2827433388230814, 0.289026524130261, 0.29530970943744056, 0.30159289474462014, 0.3078760800517997, 0.3141592653589793, 0.3204424506661589, 0.32672563597333854, 0.33300882128051806, 0.33929200658769765, 0.3455751918948773, 0.3518583772020568, 0.3581415625092364, 0.36442474781641604, 0.37070793312359557, 0.37699111843077515, 0.3832743037379548, 0.3895574890451343, 0.39584067435231396, 0.40212385965949354, 0.40840704496667307, 0.4146902302738527, 0.4209734155810323, 0.4272566008882119, 0.43353978619539146, 0.43982297150257105, 0.44610615680975063, 0.4523893421169302, 0.4586725274241098, 0.4649557127312894, 0.47123889803846897, 0.47752208334564855, 0.48380526865282814, 0.4900884539600077, 0.49637163926718736, 0.5026548245743669, 0.5089380098815465, 0.515221195188726, 0.5215043804959058, 0.5277875658030853, 0.5340707511102648, 0.5403539364174444, 0.546637121724624, 0.5529203070318035, 0.5592034923389833, 0.5654866776461628, 0.5717698629533423, 0.578053048260522, 0.5843362335677015, 0.5906194188748811, 0.5969026041820608, 0.6031857894892403, 0.6094689747964198, 0.6157521601035995, 0.6220353454107791, 0.6283185307179586, 0.6346017160251383, 0.6408849013323178, 0.6471680866394973, 0.6534512719466771, 0.6597344572538566, 0.6660176425610361, 0.6723008278682158, 0.6785840131753953, 0.6848671984825748, 0.6911503837897546, 0.6974335690969341, 0.7037167544041136, 0.7099999397112933, 0.7162831250184728, 0.7225663103256524, 0.7288494956328321, 0.7351326809400116, 0.7414158662471911, 0.7476990515543708, 0.7539822368615503, 0.7602654221687299, 0.7665486074759096, 0.7728317927830891, 0.7791149780902686, 0.7853981633974483, 0.7916813487046279, 0.7979645340118074, 0.8042477193189871, 0.8105309046261666, 0.8168140899333461, 0.8230972752405259, 0.8293804605477054, 0.835663645854885, 0.8419468311620646, 0.8482300164692441, 0.8545132017764238, 0.8607963870836034, 0.8670795723907829, 0.8733627576979625, 0.8796459430051421, 0.8859291283123216, 0.8922123136195013, 0.8984954989266809, 0.9047786842338604, 0.91106186954104, 0.9173450548482196, 0.9236282401553992, 0.9299114254625788, 0.9361946107697584, 0.9424777960769379, 0.9487609813841175, 0.9550441666912971, 0.9613273519984767, 0.9676105373056563, 0.9738937226128359, 0.9801769079200154, 0.986460093227195, 0.9927432785343747, 0.9990264638415542, 1.0053096491487339, 1.0115928344559133, 1.017876019763093, 1.0241592050702726, 1.030442390377452, 1.0367255756846316, 1.0430087609918115, 1.049291946298991, 1.0555751316061706, 1.0618583169133502, 1.0681415022205296, 1.0744246875277093, 1.080707872834889, 1.0869910581420683, 1.093274243449248, 1.0995574287564276, 1.105840614063607, 1.1121237993707869, 1.1184069846779665, 1.124690169985146, 1.1309733552923256, 1.1372565405995052, 1.1435397259066846, 1.1498229112138643, 1.156106096521044, 1.1623892818282233, 1.168672467135403, 1.1749556524425828, 1.1812388377497622, 1.1875220230569419, 1.1938052083641215, 1.200088393671301, 1.2063715789784806, 1.2126547642856602, 1.2189379495928396, 1.2252211349000193, 1.231504320207199, 1.2377875055143783, 1.2440706908215582, 1.2503538761287378, 1.2566370614359172, 1.2629202467430969, 1.2692034320502765, 1.275486617357456, 1.2817698026646356, 1.2880529879718152, 1.2943361732789946, 1.3006193585861743, 1.3069025438933541, 1.3131857292005336, 1.3194689145077132, 1.3257520998148928, 1.3320352851220723, 1.338318470429252, 1.3446016557364315, 1.350884841043611, 1.3571680263507906, 1.3634512116579702, 1.3697343969651496, 1.3760175822723295, 1.3823007675795091, 1.3885839528866886, 1.3948671381938682, 1.4011503235010478, 1.4074335088082273, 1.413716694115407, 1.4199998794225865, 1.426283064729766, 1.4325662500369456, 1.4388494353441252, 1.4451326206513049, 1.4514158059584845, 1.4576989912656642, 1.4639821765728436, 1.4702653618800232, 1.4765485471872029, 1.4828317324943823, 1.489114917801562, 1.4953981031087415, 1.501681288415921, 1.5079644737231006, 1.5142476590302805, 1.5205308443374599, 1.5268140296446395, 1.5330972149518192, 1.5393804002589986, 1.5456635855661782, 1.5519467708733579, 1.5582299561805373, 1.564513141487717, 1.5707963267948966, 1.5770795121020762, 1.5833626974092558, 1.5896458827164355, 1.595929068023615, 1.6022122533307945, 1.6084954386379742, 1.6147786239451536, 1.6210618092523332, 1.6273449945595129, 1.6336281798666923, 1.639911365173872, 1.6461945504810518, 1.6524777357882312, 1.6587609210954108, 1.6650441064025905, 1.67132729170977, 1.6776104770169495, 1.6838936623241292, 1.6901768476313086, 1.6964600329384882, 1.7027432182456679, 1.7090264035528475, 1.7153095888600272, 1.7215927741672068, 1.7278759594743862, 1.7341591447815659, 1.7404423300887455, 1.746725515395925, 1.7530087007031045, 1.7592918860102842, 1.7655750713174636, 1.7718582566246432, 1.778141441931823, 1.7844246272390025, 1.7907078125461822, 1.7969909978533618, 1.8032741831605412, 1.8095573684677209, 1.8158405537749005, 1.82212373908208, 1.8284069243892596, 1.8346901096964392, 1.8409732950036186, 1.8472564803107985, 1.8535396656179781, 1.8598228509251575, 1.8661060362323372, 1.8723892215395168, 1.8786724068466962, 1.8849555921538759, 1.8912387774610555, 1.897521962768235, 1.9038051480754146, 1.9100883333825942, 1.9163715186897738, 1.9226547039969535, 1.9289378893041331, 1.9352210746113125, 1.9415042599184922, 1.9477874452256718, 1.9540706305328512, 1.9603538158400309, 1.9666370011472105, 1.97292018645439, 1.9792033717615698, 1.9854865570687494, 1.9917697423759289, 1.9980529276831085, 2.004336112990288, 2.0106192982974678, 2.016902483604647, 2.0231856689118266, 2.0294688542190062, 2.035752039526186, 2.0420352248333655, 2.048318410140545, 2.054601595447725, 2.060884780754904, 2.067167966062084, 2.0734511513692633, 2.079734336676443, 2.086017521983623, 2.092300707290802, 2.098583892597982, 2.1048670779051615, 2.111150263212341, 2.1174334485195203, 2.1237166338267004, 2.1299998191338796, 2.1362830044410592, 2.142566189748239, 2.1488493750554185, 2.155132560362598, 2.161415745669778, 2.1676989309769574, 2.1739821162841366, 2.1802653015913167, 2.186548486898496, 2.1928316722056755, 2.199114857512855, 2.205398042820035, 2.211681228127214, 2.217964413434394, 2.2242475987415737, 2.230530784048753, 2.236813969355933, 2.243097154663112, 2.249380339970292, 2.2556635252774715, 2.261946710584651, 2.2682298958918303, 2.2745130811990104, 2.28079626650619, 2.2870794518133692, 2.2933626371205493, 2.2996458224277285, 2.305929007734908, 2.312212193042088, 2.3184953783492674, 2.3247785636564466, 2.3310617489636267, 2.337344934270806, 2.3436281195779856, 2.3499113048851656, 2.356194490192345, 2.3624776754995245, 2.368760860806704, 2.3750440461138838, 2.381327231421063, 2.387610416728243, 2.3938936020354222, 2.400176787342602, 2.4064599726497815, 2.412743157956961, 2.419026343264141, 2.4253095285713204, 2.4315927138785, 2.4378758991856793, 2.4441590844928593, 2.4504422698000385, 2.456725455107218, 2.463008640414398, 2.4692918257215775, 2.4755750110287567, 2.4818581963359367, 2.4881413816431164, 2.4944245669502956, 2.5007077522574757, 2.506990937564655, 2.5132741228718345, 2.519557308179014, 2.5258404934861938, 2.532123678793373, 2.538406864100553, 2.5446900494077322, 2.550973234714912, 2.557256420022092, 2.563539605329271, 2.569822790636451, 2.5761059759436304, 2.58238916125081, 2.5886723465579893, 2.5949555318651694, 2.6012387171723486, 2.607521902479528, 2.6138050877867083, 2.6200882730938875, 2.626371458401067, 2.6326546437082468, 2.6389378290154264, 2.6452210143226056, 2.6515041996297857, 2.657787384936965, 2.6640705702441445, 2.670353755551324, 2.676636940858504, 2.6829201261656834, 2.689203311472863, 2.6954864967800427, 2.701769682087222, 2.708052867394402, 2.714336052701581, 2.720619238008761, 2.7269024233159405, 2.73318560862312, 2.7394687939302993, 2.7457519792374794, 2.752035164544659, 2.758318349851838, 2.7646015351590183, 2.7708847204661975, 2.777167905773377, 2.7834510910805568, 2.7897342763877364, 2.7960174616949156, 2.8023006470020957, 2.808583832309275, 2.8148670176164545, 2.8211502029236346, 2.827433388230814, 2.8337165735379934, 2.839999758845173, 2.8462829441523527, 2.852566129459532, 2.858849314766712, 2.865132500073891, 2.871415685381071, 2.8776988706882505, 2.88398205599543, 2.8902652413026098, 2.8965484266097894, 2.902831611916969, 2.9091147972241482, 2.9153979825313283, 2.9216811678385075, 2.927964353145687, 2.934247538452867, 2.9405307237600464, 2.9468139090672256, 2.9530970943744057, 2.9593802796815853, 2.9656634649887645, 2.9719466502959446, 2.978229835603124, 2.9845130209103035, 2.990796206217483, 2.9970793915246627, 3.003362576831842, 3.009645762139022, 3.015928947446201, 3.022212132753381, 3.028495318060561, 3.03477850336774, 3.0410616886749198, 3.0473448739820994, 3.053628059289279, 3.0599112445964582, 3.0661944299036383, 3.0724776152108175, 3.078760800517997, 3.0850439858251772, 3.0913271711323564, 3.097610356439536, 3.1038935417467157, 3.1101767270538954, 3.1164599123610746, 3.1227430976682546, 3.129026282975434, 3.1353094682826135, 3.141592653589793, 3.1478758388969728, 3.1541590242041524, 3.160442209511332, 3.1667253948185117, 3.173008580125691, 3.179291765432871, 3.18557495074005, 3.19185813604723, 3.1981413213544094, 3.204424506661589, 3.2107076919687683, 3.2169908772759483, 3.223274062583128, 3.229557247890307, 3.2358404331974873, 3.2421236185046665, 3.248406803811846, 3.2546899891190257, 3.2609731744262054, 3.2672563597333846, 3.2735395450405647, 3.279822730347744, 3.2861059156549235, 3.2923891009621036, 3.2986722862692828, 3.3049554715764624, 3.311238656883642, 3.3175218421908217, 3.323805027498001, 3.330088212805181, 3.33637139811236, 3.34265458341954, 3.3489377687267194, 3.355220954033899, 3.3615041393410787, 3.3677873246482584, 3.374070509955438, 3.380353695262617, 3.3866368805697973, 3.3929200658769765, 3.399203251184156, 3.4054864364913358, 3.4117696217985154, 3.418052807105695, 3.4243359924128747, 3.4306191777200543, 3.4369023630272335, 3.4431855483344136, 3.449468733641593, 3.4557519189487724, 3.462035104255952, 3.4683182895631317, 3.474601474870311, 3.480884660177491, 3.4871678454846706, 3.49345103079185, 3.49973421609903, 3.506017401406209, 3.5123005867133887, 3.5185837720205684, 3.524866957327748, 3.531150142634927, 3.5374333279421073, 3.5437165132492865, 3.549999698556466, 3.556282883863646, 3.5625660691708254, 3.568849254478005, 3.5751324397851847, 3.5814156250923643, 3.5876988103995435, 3.5939819957067236, 3.600265181013903, 3.6065483663210824, 3.612831551628262, 3.6191147369354417, 3.6253979222426214, 3.631681107549801, 3.6379642928569806, 3.64424747816416, 3.65053066347134, 3.656813848778519, 3.6630970340856988, 3.6693802193928784, 3.675663404700058, 3.6819465900072372, 3.6882297753144173, 3.694512960621597, 3.700796145928776, 3.7070793312359562, 3.7133625165431354, 3.719645701850315, 3.7259288871574947, 3.7322120724646743, 3.7384952577718535, 3.7447784430790336, 3.751061628386213, 3.7573448136933925, 3.7636279990005725, 3.7699111843077517, 3.7761943696149314, 3.782477554922111, 3.7887607402292907, 3.79504392553647, 3.80132711084365, 3.807610296150829, 3.8138934814580088, 3.8201766667651884, 3.826459852072368, 3.8327430373795477, 3.8390262226867273, 3.845309407993907, 3.851592593301086, 3.8578757786082662, 3.8641589639154454, 3.870442149222625, 3.8767253345298047, 3.8830085198369844, 3.889291705144164, 3.8955748904513436, 3.9018580757585233, 3.9081412610657025, 3.9144244463728826, 3.9207076316800618, 3.9269908169872414, 3.933274002294421, 3.9395571876016007, 3.94584037290878, 3.95212355821596, 3.9584067435231396, 3.964689928830319, 3.970973114137499, 3.977256299444678, 3.9835394847518577, 3.9898226700590373, 3.996105855366217, 4.002389040673396, 4.008672225980576, 4.0149554112877555, 4.0212385965949355, 4.027521781902115, 4.033804967209294, 4.040088152516474, 4.046371337823653, 4.052654523130833, 4.0589377084380125, 4.065220893745193, 4.071504079052372, 4.077787264359552, 4.084070449666731, 4.09035363497391, 4.09663682028109, 4.10292000558827, 4.10920319089545, 4.115486376202629, 4.121769561509808, 4.128052746816988, 4.134335932124168, 4.140619117431347, 4.146902302738527, 4.153185488045707, 4.159468673352886, 4.165751858660065, 4.172035043967246, 4.178318229274425, 4.184601414581604, 4.190884599888784, 4.197167785195964, 4.203450970503143, 4.209734155810323, 4.216017341117502, 4.222300526424682, 4.228583711731861, 4.234866897039041, 4.241150082346221, 4.247433267653401, 4.25371645296058, 4.259999638267759, 4.266282823574939, 4.2725660088821185, 4.278849194189298, 4.285132379496478, 4.291415564803658, 4.297698750110837, 4.303981935418016, 4.310265120725196, 4.3165483060323755, 4.322831491339556, 4.329114676646735, 4.335397861953915, 4.341681047261094, 4.347964232568273, 4.354247417875452, 4.360530603182633, 4.366813788489813, 4.373096973796992, 4.379380159104172, 4.385663344411351, 4.39194652971853, 4.39822971502571, 4.4045129003328904, 4.41079608564007, 4.417079270947249, 4.423362456254428, 4.429645641561608, 4.435928826868788, 4.442212012175967, 4.4484951974831475, 4.454778382790327, 4.461061568097506, 4.467344753404685, 4.473627938711866, 4.479911124019045, 4.486194309326224, 4.4924774946334045, 4.498760679940584, 4.505043865247763, 4.511327050554943, 4.517610235862123, 4.523893421169302, 4.5301766064764815, 4.536459791783661, 4.542742977090841, 4.549026162398021, 4.5553093477052, 4.56159253301238, 4.567875718319559, 4.5741589036267385, 4.580442088933918, 4.586725274241099, 4.593008459548278, 4.599291644855457, 4.605574830162636, 4.611858015469816, 4.6181412007769955, 4.624424386084176, 4.630707571391356, 4.636990756698535, 4.643273942005714, 4.649557127312893, 4.655840312620073, 4.6621234979272534, 4.668406683234433, 4.674689868541612, 4.680973053848792, 4.687256239155971, 4.69353942446315, 4.699822609770331, 4.7061057950775105, 4.71238898038469, 4.718672165691869, 4.724955350999049, 4.731238536306228, 4.737521721613408, 4.743804906920587, 4.7500880922277675, 4.756371277534947, 4.762654462842126, 4.768937648149306, 4.775220833456486, 4.781504018763665, 4.7877872040708445, 4.7940703893780245, 4.800353574685204, 4.806636759992383, 4.812919945299563, 4.819203130606743, 4.825486315913922, 4.8317695012211015, 4.838052686528282, 4.844335871835461, 4.850619057142641, 4.85690224244982, 4.863185427757, 4.869468613064179, 4.8757517983713585, 4.882034983678538, 4.888318168985719, 4.894601354292898, 4.900884539600077, 4.907167724907257, 4.913450910214436, 4.919734095521616, 4.926017280828796, 4.932300466135976, 4.938583651443155, 4.944866836750334, 4.951150022057513, 4.957433207364693, 4.9637163926718735, 4.969999577979053, 4.976282763286233, 4.982565948593412, 4.988849133900591, 4.99513231920777, 5.001415504514951, 5.0076986898221305, 5.01398187512931, 5.020265060436489, 5.026548245743669, 5.032831431050848, 5.039114616358028, 5.045397801665208, 5.0516809869723875, 5.057964172279567, 5.064247357586746, 5.070530542893926, 5.076813728201106, 5.083096913508285, 5.0893800988154645, 5.095663284122645, 5.101946469429824, 5.108229654737003, 5.114512840044184, 5.120796025351363, 5.127079210658542, 5.1333623959657215, 5.139645581272902, 5.145928766580081, 5.152211951887261, 5.15849513719444, 5.16477832250162, 5.171061507808799, 5.177344693115979, 5.183627878423159, 5.189911063730339, 5.196194249037518, 5.202477434344697, 5.208760619651877, 5.215043804959056, 5.221326990266236, 5.227610175573417, 5.233893360880596, 5.240176546187775, 5.246459731494954, 5.252742916802134, 5.259026102109313, 5.2653092874164935, 5.271592472723673, 5.277875658030853, 5.284158843338032, 5.290442028645211, 5.296725213952391, 5.303008399259571, 5.3092915845667505, 5.31557476987393, 5.32185795518111, 5.328141140488289, 5.334424325795468, 5.340707511102648, 5.346990696409828, 5.353273881717008, 5.359557067024187, 5.365840252331367, 5.372123437638546, 5.378406622945726, 5.384689808252905, 5.390972993560085, 5.397256178867265, 5.403539364174444, 5.409822549481623, 5.416105734788804, 5.422388920095983, 5.428672105403162, 5.4349552907103424, 5.441238476017522, 5.447521661324701, 5.453804846631881, 5.460088031939061, 5.46637121724624, 5.472654402553419, 5.478937587860599, 5.485220773167779, 5.491503958474959, 5.497787143782138, 5.504070329089318, 5.510353514396497, 5.516636699703676, 5.522919885010856, 5.529203070318037, 5.535486255625216, 5.541769440932395, 5.548052626239574, 5.554335811546754, 5.5606189968539335, 5.5669021821611135, 5.573185367468294, 5.579468552775473, 5.585751738082652, 5.592034923389831, 5.598318108697011, 5.604601294004191, 5.610884479311371, 5.61716766461855, 5.62345084992573, 5.629734035232909, 5.636017220540088, 5.642300405847269, 5.648583591154448, 5.654866776461628, 5.661149961768807, 5.667433147075987, 5.673716332383166, 5.679999517690346, 5.686282702997525, 5.6925658883047054, 5.698849073611885, 5.705132258919064, 5.711415444226244, 5.717698629533424, 5.723981814840603, 5.730265000147782, 5.7365481854549625, 5.742831370762142, 5.749114556069321, 5.755397741376501, 5.761680926683681, 5.76796411199086, 5.774247297298039, 5.7805304826052195, 5.786813667912399, 5.793096853219579, 5.799380038526758, 5.805663223833938, 5.811946409141117, 5.8182295944482965, 5.824512779755476, 5.830795965062657, 5.837079150369836, 5.843362335677015, 5.849645520984195, 5.855928706291374, 5.8622118915985535, 5.868495076905734, 5.874778262212914, 5.881061447520093, 5.887344632827272, 5.893627818134451, 5.899911003441631, 5.906194188748811, 5.912477374055991, 5.918760559363171, 5.92504374467035, 5.931326929977529, 5.937610115284708, 5.943893300591889, 5.9501764858990684, 5.956459671206248, 5.962742856513427, 5.969026041820607, 5.975309227127786, 5.981592412434966, 5.987875597742146, 5.9941587830493255, 6.000441968356505, 6.006725153663684, 6.013008338970864, 6.019291524278044, 6.025574709585223, 6.031857894892402, 6.0381410801995825, 6.044424265506762, 6.050707450813941, 6.056990636121122, 6.063273821428301, 6.06955700673548, 6.0758401920426595, 6.0821233773498395, 6.088406562657019, 6.094689747964199, 6.100972933271379, 6.107256118578558, 6.113539303885737, 6.1198224891929165, 6.126105674500097, 6.132388859807277, 6.138672045114456, 6.144955230421635, 6.151238415728815, 6.157521601035994, 6.1638047863431735, 6.1700879716503545, 6.176371156957534, 6.182654342264713, 6.188937527571892, 6.195220712879072, 6.201503898186251, 6.2077870834934314, 6.214070268800611, 6.220353454107791, 6.22663663941497, 6.232919824722149, 6.239203010029329, 6.245486195336509, 6.2517693806436885, 6.258052565950868, 6.264335751258048, 6.270618936565227, 6.276902121872406]
)
    radius = 1000.0  
    ringworld_velocity = 1000
    
    y_force = np.array([0.0, -6.4409690114607376e-24, -1.2854353139211803e-23, -1.9212889084880788e-23, -2.548994940066072e-23, -3.165984238854613e-23, -3.769809112088492e-23, -4.358168583234886e-23, -4.928930488463902e-23, -5.48015005948864e-23, -6.010084739164969e-23, -6.517205096213565e-23, -7.000201822653071e-23, -7.457988907139973e-23, -7.889703175324743e-23, -8.294700471456472e-23, -8.672548821758593e-23, -9.023018968575769e-23, -9.346072694962052e-23, -9.641849373109153e-23, -9.910651168359802e-23, -1.0152927315574578e-22, -1.0369257858703298e-22, -1.0560337210065107e-22, -1.072695784556368e-22, -1.0869994408206488e-22, -1.0990388446971007e-22, -1.1089133973078578e-22, -1.1167263972574133e-22, -1.122583797390393e-22, -1.12659307327446e-22, -1.1288622064172149e-22, -1.1294987824622452e-22, -1.1286092023013299e-22, -1.126298002173294e-22, -1.1226672773680151e-22, -1.1178162030803599e-22, -1.1118406452217974e-22, -1.1048328535526672e-22, -1.0968812293009627e-22, -1.0880701594406636e-22, -1.0784799099739163e-22, -1.0681865708595264e-22, -1.0572620456228196e-22, -1.0457740791403268e-22, -1.0337863175928274e-22, -1.0213583951019008e-22, -1.0085460420921091e-22, -9.954012109402107e-23, -9.81972214974715e-23, -9.683038773662714e-23, -9.544376868969247e-23, -9.404119580108927e-23, -9.262619929296283e-23, -9.120202439590315e-23, -8.977164744271261e-23, -8.833779169675732e-23, -8.690294281095809e-23, -8.546936383501345e-23, -8.403910970721147e-23, -8.261404118342054e-23, -8.11958381697692e-23, -7.97860124373672e-23, -7.838591970740642e-23, -7.6996771103311e-23, -7.561964397348213e-23, -7.425549209378594e-23, -7.29051552634218e-23, -7.156936831134053e-23, -7.024876953308683e-23, -6.894390857994263e-23, -6.765525382365388e-23, -6.638319922092629e-23, -6.512807070236292e-23, -6.389013211065669e-23, -6.266959071270995e-23, -6.146660230998406e-23, -6.028127597083579e-23, -5.911367840790493e-23, -5.796383802282566e-23, -5.683174863965984e-23, -5.571737294752584e-23, -5.462064567193639e-23, -5.35414764933861e-23, -5.247975273074713e-23, -5.1435341806063954e-23, -5.0408093506382984e-23, -4.939784205732187e-23, -4.840440802218269e-23, -4.7427600039542287e-23, -4.646721641142198e-23, -4.5523046553339157e-23, -4.4594872316788155e-23, -4.3682469193976575e-23, -4.27856074139635e-23, -4.190405293870403e-23, -4.103756836689897e-23, -4.018591375298173e-23, -3.9348847348039495e-23, -3.8526126268969214e-23, -3.7717507101699537e-23, -3.6922746443876485e-23, -3.614160139200279e-23, -3.537382997764314e-23, -3.461919155695502e-23, -3.3877447157477487e-23, -3.3148359785805775e-23, -3.2431694699498865e-23, -3.172721964630284e-23, -3.103470507353265e-23, -3.035392431022927e-23, -2.968465372450108e-23, -2.902667285826642e-23, -2.8379764541436194e-23, -2.7743714987411283e-23, -2.7118313871616996e-23, -2.650335439465762e-23, -2.5898633331543879e-23, -2.5303951068327006e-23, -2.471911162736316e-23, -2.41439226823304e-23, -2.3578195564026044e-23, -2.302174525788771e-23, -2.2474390394099956e-23, -2.193595323107643e-23, -2.140625963304059e-23, -2.088513904236407e-23, -2.0372424447267296e-23, -1.98679523454323e-23, -1.9371562704031213e-23, -1.8883098916627822e-23, -1.8402407757370747e-23, -1.7929339332857477e-23, -1.7463747032015428e-23, -1.7005487474314027e-23, -1.6554420456592833e-23, -1.6110408898764283e-23, -1.5673318788625062e-23, -1.5243019125987643e-23, -1.4819381866323326e-23, -1.440228186408884e-23, -1.3991596815891812e-23, -1.3587207203634003e-23, -1.318899623775755e-23, -1.2796849800705245e-23, -1.2410656390694973e-23, -1.2030307065896061e-23, -1.1655695389086362e-23, -1.128671737285895e-23, -1.0923271425439023e-23, -1.0565258297164336e-23, -1.0212581027674767e-23, -9.86514489385109e-24, -9.522857358536432e-24, -9.185628020069426e-24, -8.853368562652557e-24, -8.525992707575315e-24, -8.203416165307871e-24, -7.88555658847709e-24, -7.572333525733969e-24, -7.263668376518099e-24, -6.959484346722878e-24, -6.65970640526217e-24, -6.364261241537518e-24, -6.073077223802833e-24, -5.7860843584219035e-24, -5.503214250012736e-24, -5.224400062471207e-24, -4.949576480865231e-24, -4.678679674190228e-24, -4.411647258974908e-24, -4.1484182637264255e-24, -3.8889330942027214e-24, -3.633133499499594e-24, -3.3809625389393365e-24, -3.132364549747782e-24, -2.8872851155056212e-24, -2.645671035360136e-24, -2.4074702939832886e-24, -2.1726320322612533e-24, -1.9411065187013756e-24, -1.712845121541823e-24, -1.4878002815491517e-24, -1.2659254854894818e-24, -1.0471752402585447e-24, -8.315050476563073e-25, -6.188713797916068e-25, -4.0923165510265033e-25, -2.0254421497941284e-25, 1.2316990264364184e-27, 2.0213596741725727e-25, 4.002076144050627e-25, 5.954848290199238e-25, 7.880049856846061e-25, 9.778046642684008e-25, 1.1649196696328445e-24, 1.3493850506819193e-24, 1.5312351189289829e-24, 1.7105034665926108e-24, 1.8872229842329642e-24, 2.0614258779405237e-24, 2.2331436860884736e-24, 2.402407295659628e-24, 2.569246958159112e-24, 2.7336923051232535e-24, 2.89577236323499e-24, 3.0555155690561517e-24, 3.2129497833864434e-24, 3.3681023052587525e-24, 3.520999885580306e-24, 3.671668740428997e-24, 3.820134564013704e-24, 3.966422541307521e-24, 4.1105573603624295e-24, 4.252563224313764e-24, 4.392463863082635e-24, 4.5302825447842265e-24, 4.6660420868496955e-24, 4.799764866869285e-24, 4.931472833163916e-24, 5.061187515092317e-24, 5.1889300331010445e-24, 5.314721108523638e-24, 5.438581073135919e-24, 5.5605298784737075e-24, 5.680587104919242e-24, 5.7987719705623795e-24, 5.915103339842538e-24, 6.029599731977118e-24, 6.142279329181998e-24, 6.2531599846897266e-24, 6.3622592305705e-24, 6.4695942853612e-24, 6.575182061507623e-24, 6.679039172624655e-24, 6.781181940579214e-24, 6.88162640240057e-24, 6.980388317022651e-24, 7.077483171862542e-24, 7.172926189239618e-24, 7.266732332639349e-24, 7.358916312825878e-24, 7.449492593807202e-24, 7.538475398656972e-24, 7.625878715196323e-24, 7.711716301539676e-24, 7.796001691507798e-24, 7.87874819991156e-24, 7.95996892770987e-24, 8.039676767044816e-24, 8.117884406157307e-24, 8.194604334186185e-24, 8.269848845853855e-24, 8.343630046041221e-24, 8.415959854254888e-24, 8.486850008989228e-24, 8.556312071986065e-24, 8.624357432394488e-24, 8.690997310833443e-24, 8.756242763359406e-24, 8.82010468534158e-24, 8.882593815247024e-24, 8.943720738337791e-24, 9.00349589028244e-24, 9.061929560683956e-24, 9.119031896526221e-24, 9.174812905540953e-24, 9.229282459497279e-24, 9.2824502974156e-24, 9.334326028707807e-24, 9.384919136245653e-24, 9.434238979358857e-24, 9.482294796764886e-24, 9.529095709431988e-24, 9.574650723377071e-24, 9.618968732400063e-24, 9.66205852075629e-24, 9.703928765768301e-24, 9.744588040378748e-24, 9.784044815645605e-24, 9.822307463181099e-24, 9.859384257535895e-24, 9.895283378529581e-24, 9.930012913528972e-24, 9.963580859675243e-24, 9.995995126061342e-24, 1.0027263535860662e-23, 1.0057393828408258e-23, 1.0086393661235631e-23, 1.0114270612060258e-23, 1.0141032180730812e-23, 1.0166685791129282e-23, 1.0191238793030751e-23, 1.0214698463922113e-23, 1.0237072010780384e-23, 1.0258366571811804e-23, 1.0278589218152406e-23, 1.029774695553114e-23, 1.0315846725896221e-23, 1.0332895409005761e-23, 1.0348899823983233e-23, 1.0363866730838823e-23, 1.037780283195729e-23, 1.0390714773553122e-23, 1.0402609147093775e-23, 1.0413492490691653e-23, 1.0423371290465551e-23, 1.0432251981872255e-23, 1.0440140951009003e-23, 1.044704453588734e-23, 1.04529690276791e-23, 1.0457920671935173e-23, 1.0461905669777485e-23, 1.0464930179064972e-23, 1.0467000315534017e-23, 1.0468122153913878e-23, 1.0468301729017826e-23, 1.0467545036810245e-23, 1.0465858035450526e-23, 1.0463246646313967e-23, 1.0459716754990432e-23, 1.0455274212261038e-23, 1.0449924835053522e-23, 1.0443674407376571e-23, 1.0436528681233694e-23, 1.042849337751706e-23, 1.0419574186881635e-23, 1.0409776770600147e-23, 1.039910676139921e-23, 1.038756976427702e-23, 1.0375171357303092e-23, 1.0361917092400238e-23, 1.0347812496109341e-23, 1.0332863070337193e-23, 1.0317074293087722e-23, 1.030045161917704e-23, 1.0283000480932585e-23, 1.0264726288876676e-23, 1.024563443239488e-23, 1.0225730280389377e-23, 1.020501918191778e-23, 1.0183506466817558e-23, 1.0161197446316466e-23, 1.0138097413629224e-23, 1.0114211644540715e-23, 1.0089545397975987e-23, 1.0064103916557326e-23, 1.0037892427148657e-23, 1.0010916141387533e-23, 9.983180256204929e-24, 9.95468995433315e-24, 9.925450404802008e-24, 9.895466763423583e-24, 9.864744173265707e-24, 9.833287765114485e-24, 9.801102657925984e-24, 9.768193959267372e-24, 9.734566765747682e-24, 9.700226163438371e-24, 9.665177228283951e-24, 9.629425026502847e-24, 9.592974614978614e-24, 9.555831041641794e-24, 9.517999345842578e-24, 9.479484558714356e-24, 9.44029170352846e-24, 9.400425796040187e-24, 9.35989184482629e-24, 9.318694851614105e-24, 9.27683981160249e-24, 9.234331713774674e-24, 9.19117554120322e-24, 9.147376271347302e-24, 9.10293887634226e-24, 9.057868323281806e-24, 9.012169574492886e-24, 8.965847587803316e-24, 8.91890731680243e-24, 8.871353711094795e-24, 8.823191716547144e-24, 8.774426275528653e-24, 8.725062327144703e-24, 8.675104807464206e-24, 8.624558649740666e-24, 8.57342878462706e-24, 8.521720140384661e-24, 8.469437643085918e-24, 8.416586216811502e-24, 8.363170783841618e-24, 8.309196264841708e-24, 8.25466757904265e-24, 8.199589644415501e-24, 8.143967377840957e-24, 8.087805695273607e-24, 8.031109511901041e-24, 7.973883742297937e-24, 7.91613330057523e-24, 7.857863100524435e-24, 7.799078055757194e-24, 7.739783079840204e-24, 7.679983086425496e-24, 7.619682989376303e-24, 7.558887702888455e-24, 7.497602141607461e-24, 7.435831220741328e-24, 7.373579856169265e-24, 7.31085296454618e-24, 7.24765546340327e-24, 7.183992271244622e-24, 7.119868307639894e-24, 7.055288493313272e-24, 6.990257750228662e-24, 6.924781001671212e-24, 6.85886317232523e-24, 6.792509188348661e-24, 6.725723977443948e-24, 6.658512468925659e-24, 6.5908795937846864e-24, 6.5228302847491815e-24, 6.454369476342334e-24, 6.385502104936945e-24, 6.3162331088069554e-24, 6.246567428175896e-24, 6.176510005262454e-24, 6.1060657843230015e-24, 6.035239711691386e-24, 5.9640367358158215e-24, 5.8924618072931144e-24, 5.820519878900108e-24, 5.748215905622561e-24, 5.6755548446813726e-24, 5.602541655556303e-24, 5.529181300007226e-24, 5.455478742092841e-24, 5.381438948187124e-24, 5.307066886993346e-24, 5.232367529555829e-24, 5.157345849269411e-24, 5.0820068218868185e-24, 5.00635542552372e-24, 4.9303966406617926e-24, 4.8541354501496875e-24, 4.777576839201931e-24, 4.700725795395899e-24, 4.623587308666823e-24, 4.546166371300899e-24, 4.4684679779265434e-24, 4.3904971255038744e-24, 4.312258813312322e-24, 4.233758042936615e-24, 4.154999818251037e-24, 4.075989145401949e-24, 3.9967310327888374e-24, 3.917230491043671e-24, 3.837492533008784e-24, 3.757522173713187e-24, 3.677324430347525e-24, 3.596904322237468e-24, 3.516266870815829e-24, 3.435417099593267e-24, 3.3543600341276554e-24, 3.2731007019922255e-24, 3.1916441327423937e-24, 3.1099953578814227e-24, 3.028159410824839e-24, 2.9461413268638232e-24, 2.8639461431273097e-24, 2.781578898543172e-24, 2.6990446337982593e-24, 2.6163483912974637e-24, 2.533495215121756e-24, 2.450490150985367e-24, 2.367338246191935e-24, 2.28404454958982e-24, 2.2006141115266246e-24, 2.117051983802751e-24, 2.0333632196243038e-24, 1.9495528735551515e-24, 1.865626001468288e-24, 1.7815876604964596e-24, 1.6974429089822136e-24, 1.6131968064271596e-24, 1.5288544134407654e-24, 1.4444207916885196e-24, 1.3599010038394824e-24, 1.2753001135134353e-24, 1.1906231852274496e-24, 1.105875284342043e-24, 1.0210614770068482e-24, 9.36186830105994e-25, 8.51256411202947e-25, 7.662752884851694e-25, 6.812485307083835e-25, 5.961812071405157e-25, 5.11078387505482e-25, 4.25945141926664e-25, 3.4078654087022367e-25, 2.5560765508820457e-25, 1.704135555615892e-25, 8.520931344308887e-26, 1.6608192017768823e-39, -8.520931344308554e-26, -1.7041355556158587e-25, -2.5560765508820723e-25, -3.407865408702204e-25, -4.259451419266607e-25, -5.110783875054848e-25, -5.961812071405124e-25, -6.812485307083801e-25, -7.6627528848517185e-25, -8.512564112029443e-25, -9.361868301059846e-25, -1.021061477006851e-24, -1.10587528434204e-24, -1.190623185227447e-24, -1.2753001135134373e-24, -1.3599010038394791e-24, -1.4444207916885165e-24, -1.5288544134407683e-24, -1.6131968064271545e-24, -1.6974429089822033e-24, -1.7815876604964626e-24, -1.8656260014682777e-24, -1.9495528735551467e-24, -2.0333632196243067e-24, -2.117051983802747e-24, -2.200614111526622e-24, -2.2840445495898214e-24, -2.3673382461919318e-24, -2.4504901509853643e-24, -2.5334952151217595e-24, -2.6163483912974556e-24, -2.6990446337982563e-24, -2.781578898543169e-24, -2.8639461431273064e-24, -2.9461413268638203e-24, -3.0281594108248417e-24, -3.1099953578814198e-24, -3.1916441327423907e-24, -3.2731007019922285e-24, -3.3543600341276525e-24, -3.435417099593265e-24, -3.5162668708158274e-24, -3.596904322237466e-24, -3.6773244303475205e-24, -3.7575221737131885e-24, -3.837492533008782e-24, -3.917230491043668e-24, -3.9967310327888374e-24, -4.0759891454019456e-24, -4.154999818251034e-24, -4.2337580429366214e-24, -4.312258813312318e-24, -4.3904971255038685e-24, -4.468467977926546e-24, -4.5461663713008964e-24, -4.623587308666818e-24, -4.7007257953959016e-24, -4.777576839201928e-24, -4.8541354501496875e-24, -4.930396640661792e-24, -5.0063554255237185e-24, -5.082006821886818e-24, -5.157345849269416e-24, -5.23236752955582e-24, -5.3070668869933455e-24, -5.38143894818713e-24, -5.4554787420928375e-24, -5.529181300007223e-24, -5.602541655556307e-24, -5.675554844681372e-24, -5.748215905622555e-24, -5.82051987890011e-24, -5.892461807293112e-24, -5.96403673581582e-24, -6.03523971169138e-24, -6.106065784322999e-24, -6.176510005262451e-24, -6.246567428175897e-24, -6.316233108806952e-24, -6.385502104936946e-24, -6.454369476342337e-24, -6.52283028474918e-24, -6.5908795937846834e-24, -6.65851246892566e-24, -6.725723977443946e-24, -6.792509188348652e-24, -6.85886317232523e-24, -6.924781001671209e-24, -6.99025775022866e-24, -7.055288493313277e-24, -7.11986830763989e-24, -7.183992271244623e-24, -7.247655463403273e-24, -7.310852964546177e-24, -7.373579856169256e-24, -7.435831220741333e-24, -7.497602141607455e-24, -7.558887702888452e-24, -7.619682989376305e-24, -7.679983086425493e-24, -7.7397830798402e-24, -7.799078055757199e-24, -7.857863100524435e-24, -7.916133300575227e-24, -7.973883742297933e-24, -8.031109511901035e-24, -8.087805695273606e-24, -8.143967377840955e-24, -8.199589644415498e-24, -8.254667579042656e-24, -8.30919626484171e-24, -8.363170783841618e-24, -8.416586216811498e-24, -8.469437643085919e-24, -8.52172014038466e-24, -8.573428784627058e-24, -8.624558649740668e-24, -8.675104807464203e-24, -8.7250623271447e-24, -8.77442627552865e-24, -8.823191716547142e-24, -8.87135371109479e-24, -8.918907316802428e-24, -8.965847587803313e-24, -9.012169574492883e-24, -9.057868323281804e-24, -9.102938876342254e-24, -9.147376271347297e-24, -9.191175541203225e-24, -9.234331713774672e-24, -9.27683981160249e-24, -9.318694851614108e-24, -9.359891844826285e-24, -9.400425796040186e-24, -9.440291703528462e-24, -9.479484558714356e-24, -9.517999345842578e-24, -9.555831041641797e-24, -9.592974614978608e-24, -9.629425026502849e-24, -9.665177228283951e-24, -9.70022616343837e-24, -9.734566765747679e-24, -9.768193959267373e-24, -9.801102657925984e-24, -9.83328776511448e-24, -9.864744173265707e-24, -9.89546676342358e-24, -9.925450404802006e-24, -9.954689954333147e-24, -9.983180256204918e-24, -1.0010916141387532e-23, -1.0037892427148663e-23, -1.0064103916557326e-23, -1.008954539797599e-23, -1.0114211644540713e-23, -1.0138097413629227e-23, -1.0161197446316466e-23, -1.0183506466817557e-23, -1.0205019181917778e-23, -1.0225730280389374e-23, -1.0245634432394875e-23, -1.0264726288876673e-23, -1.0283000480932586e-23, -1.030045161917704e-23, -1.0317074293087722e-23, -1.0332863070337193e-23, -1.034781249610934e-23, -1.0361917092400233e-23, -1.0375171357303086e-23, -1.0387569764277018e-23, -1.0399106761399207e-23, -1.0409776770600154e-23, -1.0419574186881636e-23, -1.0428493377517067e-23, -1.0436528681233697e-23, -1.0443674407376568e-23, -1.0449924835053524e-23, -1.045527421226104e-23, -1.0459716754990426e-23, -1.0463246646313965e-23, -1.0465858035450529e-23, -1.0467545036810248e-23, -1.0468301729017826e-23, -1.0468122153913878e-23, -1.0467000315534011e-23, -1.046493017906498e-23, -1.0461905669777486e-23, -1.045792067193518e-23, -1.0452969027679097e-23, -1.0447044535887337e-23, -1.0440140951009007e-23, -1.0432251981872256e-23, -1.042337129046555e-23, -1.0413492490691653e-23, -1.0402609147093779e-23, -1.0390714773553122e-23, -1.037780283195729e-23, -1.0363866730838819e-23, -1.0348899823983232e-23, -1.0332895409005764e-23, -1.0315846725896221e-23, -1.0297746955531136e-23, -1.0278589218152412e-23, -1.0258366571811813e-23, -1.0237072010780381e-23, -1.0214698463922116e-23, -1.0191238793030757e-23, -1.016668579112929e-23, -1.0141032180730825e-23, -1.0114270612060268e-23, -1.0086393661235628e-23, -1.0057393828408258e-23, -1.0027263535860662e-23, -9.995995126061342e-24, -9.96358085967525e-24, -9.930012913528971e-24, -9.895283378529584e-24, -9.85938425753589e-24, -9.822307463181099e-24, -9.784044815645599e-24, -9.74458804037876e-24, -9.703928765768304e-24, -9.662058520756285e-24, -9.618968732400069e-24, -9.574650723377064e-24, -9.529095709431988e-24, -9.482294796764881e-24, -9.434238979358869e-24, -9.384919136245648e-24, -9.334326028707807e-24, -9.282450297415603e-24, -9.229282459497283e-24, -9.174812905540956e-24, -9.119031896526214e-24, -9.061929560683959e-24, -9.003495890282445e-24, -8.943720738337791e-24, -8.88259381524703e-24, -8.820104685341584e-24, -8.756242763359407e-24, -8.690997310833446e-24, -8.624357432394488e-24, -8.556312071986071e-24, -8.486850008989228e-24, -8.415959854254892e-24, -8.34363004604123e-24, -8.269848845853849e-24, -8.194604334186183e-24, -8.11788440615731e-24, -8.039676767044824e-24, -7.959968927709877e-24, -7.878748199911568e-24, -7.796001691507798e-24, -7.711716301539686e-24, -7.625878715196323e-24, -7.538475398656972e-24, -7.449492593807211e-24, -7.358916312825884e-24, -7.266732332639349e-24, -7.172926189239625e-24, -7.077483171862551e-24, -6.980388317022651e-24, -6.881626402400579e-24, -6.781181940579222e-24, -6.679039172624659e-24, -6.575182061507614e-24, -6.469594285361204e-24, -6.362259230570507e-24, -6.2531599846897266e-24, -6.142279329182001e-24, -6.029599731977118e-24, -5.915103339842545e-24, -5.7987719705623795e-24, -5.680587104919242e-24, -5.560529878473722e-24, -5.4385810731359365e-24, -5.314721108523628e-24, -5.1889300331010445e-24, -5.061187515092321e-24, -4.931472833163911e-24, -4.7997648668692985e-24, -4.666042086849707e-24, -4.5302825447842324e-24, -4.3924638630826306e-24, -4.252563224313764e-24, -4.11055736036244e-24, -3.966422541307537e-24, -3.820134564013716e-24, -3.671668740428994e-24, -3.520999885580318e-24, -3.368102305258742e-24, -3.2129497833864552e-24, -3.0555155690561693e-24, -2.8957723632350092e-24, -2.7336923051232417e-24, -2.569246958159112e-24, -2.402407295659631e-24, -2.2331436860884912e-24, -2.0614258779405384e-24, -1.887222984232973e-24, -1.7105034665926108e-24, -1.53123511892898e-24, -1.3493850506819193e-24, -1.1649196696328562e-24, -9.778046642684243e-25, -7.880049856846208e-25, -5.954848290199238e-25, -4.0020761440507444e-25, -2.0213596741727784e-25, -1.2316990264364184e-27, 2.0254421497938933e-25, 4.092316551026239e-25, 6.188713797916127e-25, 8.315050476563073e-25, 1.0471752402585359e-24, 1.2659254854894524e-24, 1.4878002815491547e-24, 1.712845121541808e-24, 1.9411065187013756e-24, 2.172632032261227e-24, 2.4074702939832945e-24, 2.6456710353601273e-24, 2.88728511550558e-24, 3.1323645497477762e-24, 3.380962538939348e-24, 3.633133499499582e-24, 3.888933094202701e-24, 4.1484182637264255e-24, 4.411647258974881e-24, 4.678679674190199e-24, 4.9495764808652666e-24, 5.2244000624712185e-24, 5.503214250012736e-24, 5.7860843584218624e-24, 6.0730772238028156e-24, 6.364261241537494e-24, 6.65970640526217e-24, 6.959484346722845e-24, 7.263668376518107e-24, 7.572333525733957e-24, 7.885556588477064e-24, 8.203416165307848e-24, 8.52599270757533e-24, 8.853368562652557e-24, 9.1856280200694e-24, 9.522857358536432e-24, 9.865144893851066e-24, 1.0212581027674723e-23, 1.0565258297164327e-23, 1.0923271425439043e-23, 1.1286717372858939e-23, 1.165569538908633e-23, 1.2030307065896061e-23, 1.2410656390694948e-23, 1.2796849800705242e-23, 1.3188996237757513e-23, 1.3587207203634026e-23, 1.3991596815891795e-23, 1.440228186408881e-23, 1.481938186632327e-23, 1.5243019125987685e-23, 1.5673318788625076e-23, 1.6110408898764248e-23, 1.6554420456592833e-23, 1.7005487474314013e-23, 1.7463747032015384e-23, 1.7929339332857456e-23, 1.8402407757370792e-23, 1.8883098916627798e-23, 1.937156270403115e-23, 1.986795234543224e-23, 2.037242444726726e-23, 2.0885139042364082e-23, 2.1406259633040562e-23, 2.193595323107646e-23, 2.247439039409994e-23, 2.3021745257887666e-23, 2.357819556402597e-23, 2.414392268233044e-23, 2.4719111627363169e-23, 2.5303951068326965e-23, 2.589863333154381e-23, 2.6503354394657617e-23, 2.7118313871616943e-23, 2.774371498741128e-23, 2.837976454143625e-23, 2.902667285826641e-23, 2.968465372450105e-23, 3.035392431022919e-23, 3.1034705073532616e-23, 3.1727219646302874e-23, 3.243169469949886e-23, 3.314835978580572e-23, 3.3877447157477487e-23, 3.4619191556955005e-23, 3.537382997764305e-23, 3.6141601392002855e-23, 3.69227464438765e-23, 3.771750710169952e-23, 3.8526126268969155e-23, 3.934884734803948e-23, 4.0185913752981623e-23, 4.103756836689897e-23, 4.190405293870395e-23, 4.27856074139635e-23, 4.36824691939765e-23, 4.459487231678805e-23, 4.5523046553339104e-23, 4.6467216411422016e-23, 4.742760003954224e-23, 4.8404408022182574e-23, 4.939784205732187e-23, 5.04080935063829e-23, 5.1435341806063807e-23, 5.247975273074711e-23, 5.354147649338617e-23, 5.462064567193638e-23, 5.571737294752573e-23, 5.683174863965984e-23, 5.796383802282557e-23, 5.911367840790493e-23, 6.02812759708357e-23, 6.14666023099841e-23, 6.266959071270991e-23, 6.38901321106566e-23, 6.512807070236268e-23, 6.638319922092636e-23, 6.765525382365388e-23, 6.894390857994257e-23, 7.024876953308683e-23, 7.156936831134046e-23, 7.290515526342162e-23, 7.425549209378586e-23, 7.56196439734822e-23, 7.6996771103311e-23, 7.838591970740631e-23, 7.978601243736698e-23, 8.119583816976913e-23, 8.261404118342057e-23, 8.403910970721134e-23, 8.546936383501352e-23, 8.690294281095805e-23, 8.833779169675715e-23, 8.97716474427124e-23, 9.120202439590327e-23, 9.262619929296282e-23, 9.404119580108919e-23, 9.544376868969228e-23, 9.683038773662701e-23, 9.819722149747131e-23, 9.954012109402102e-23, 1.0085460420921093e-22, 1.0213583951019005e-22, 1.0337863175928266e-22, 1.0457740791403251e-22, 1.0572620456228184e-22, 1.0681865708595269e-22, 1.0784799099739166e-22, 1.0880701594406627e-22, 1.0968812293009623e-22, 1.104832853552667e-22, 1.111840645221795e-22, 1.1178162030803613e-22, 1.1226672773680154e-22, 1.1262980021732948e-22, 1.1286092023013299e-22, 1.129498782462245e-22, 1.1288622064172144e-22, 1.1265930732744598e-22, 1.1225837973903937e-22, 1.1167263972574124e-22, 1.1089133973078587e-22, 1.0990388446971012e-22, 1.0869994408206502e-22, 1.0726957845563676e-22, 1.0560337210065108e-22, 1.0369257858703309e-22, 1.0152927315574579e-22, 9.91065116835983e-23, 9.641849373109193e-23, 9.346072694962013e-23, 9.023018968575767e-23, 8.672548821758603e-23, 8.294700471456506e-23, 7.889703175324754e-23, 7.457988907140005e-23, 7.000201822653071e-23, 6.517205096213593e-23, 6.010084739164957e-23, 5.480150059488663e-23, 4.92893048846396e-23, 4.3581685832348995e-23, 3.769809112088462e-23, 3.1659842388546203e-23, 2.5489949400661162e-23, 1.921288908488075e-23, 1.2854353139212166e-23, 6.4409690114614994e-24])
    
    # Integrate to get velocity map
    velocity_map, arc_lengths = integrate_ringworld_velocity(y_force, angles, radius, ringworld_velocity)
    
    print(f"Integration complete!")
    print(f"Angle range: {np.degrees(angles[0]):.1f}° to {np.degrees(angles[-1]):.1f}°")
    print(f"Arc-length range: {arc_lengths[0]:.1f} to {arc_lengths[-1]:.1f}")
    print(f"Velocity range: {velocity_map.min():.3f} to {velocity_map.max():.3f}")
    print(f"Final velocity: {velocity_map[-1]:.3f}")
    
    # Uncomment to plot results
    plot_velocity_results(angles, y_force, velocity_map, radius, ringworld_velocity)
